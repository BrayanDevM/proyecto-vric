<div class="content">
  <div class="container-fluid">
    <app-breadcrumb></app-breadcrumb>
    <div class="row">
      <div class="col-12">
        <div class="card card-body mb-3 BDM_fadeInUp">
          <div class="row">
            <div class="col-3">
              <div
                class="nav flex-column nav-pills"
                id="v-pills-tab"
                role="tablist"
                aria-orientation="vertical"
              >
                <a
                  class="nav-link active"
                  id="v-pills-perfil-tab"
                  data-toggle="pill"
                  href="#v-pills-perfil"
                  role="tab"
                  aria-controls="v-pills-perfil"
                  aria-selected="true"
                  ><i class="fas fa-pencil"></i> Editar perfil</a
                >
                <a
                  class="nav-link"
                  id="v-pills-cuenta-tab"
                  data-toggle="pill"
                  href="#v-pills-cuenta"
                  role="tab"
                  aria-controls="v-pills-cuenta"
                  aria-selected="false"
                  ><i class="fas fa-user"></i> Configuración de la cuenta</a
                >
                <a
                  class="nav-link"
                  id="v-pills-UDS-tab"
                  data-toggle="pill"
                  href="#v-pills-UDS"
                  role="tab"
                  aria-controls="v-pills-UDS"
                  aria-selected="false"
                  ><i class="fas fa-home"></i> UDS asignadas</a
                >
                <!-- <a
                  class="nav-link"
                  id="v-pills-settings-tab"
                  data-toggle="pill"
                  href="#v-pills-settings"
                  role="tab"
                  aria-controls="v-pills-settings"
                  aria-selected="false"
                  ><i class="fas fa-cog fa-spin"></i> Configuración</a
                > -->
              </div>
            </div>
            <div class="col-9">
              <div class="tab-content" id="v-pills-tabContent">
                <div
                  class="tab-pane fade show active"
                  id="v-pills-perfil"
                  role="tabpanel"
                  aria-labelledby="v-pills-perfil-tab"
                >
                  <h4 class="card-title">Información de perfil</h4>
                  <!-- <h6 class="card-subtitle mb-2 text-muted">
                  Nombre: {{ usuario.nombre }}
                </h6> -->
                  <form
                    ngNativeValidate
                    [formGroup]="formPerfil"
                    (ngSubmit)="actualizarPerfil()"
                  >
                    <div class="row">
                      <div class="form-group col-3">
                        <label for="nombre">Nombre completo*</label>
                        <input
                          [ngModel]="usuario.nombre"
                          formControlName="nombre"
                          name="nombre"
                          type="text"
                          class="form-control"
                          placeholder="Nombre..."
                          required
                        />
                      </div>
                      <div class="form-group col-3">
                        <label for="documento">Documento*</label>
                        <input
                          [ngModel]="usuario.documento"
                          formControlName="documento"
                          name="documento"
                          type="text"
                          class="form-control"
                          placeholder="No. documento..."
                          required
                        />
                      </div>
                      <div class="form-group col-3">
                        <label for="correo">Correo*</label>
                        <input
                          #correo
                          [ngModel]="usuario.correo"
                          formControlName="correo"
                          name="correo"
                          type="email"
                          class="form-control"
                          placeholder="Correo..."
                          required
                        />
                        <div *ngIf="usuario.google" class="text-muted">
                          No puedes editar un correo de Google
                        </div>
                      </div>
                      <div class="form-group col-3">
                        <label for="telefono">Telefono</label>
                        <input
                          [ngModel]="usuario.telefono"
                          formControlName="telefono"
                          name="telefono"
                          type="text"
                          class="form-control"
                          placeholder="Telefono..."
                        />
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-12">
                        <span class="text-muted"
                          ><b>Rol asignado:</b> {{ usuario.rol }}</span
                        >
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-12 text-right">
                        <button
                          *ngIf="!cargando"
                          type="submit"
                          class="btn btn-success btn-sm"
                        >
                          <i class="far fa-sync"></i> Actualizar
                        </button>
                        <button
                          *ngIf="cargando"
                          type="submit"
                          class="btn btn-success btn-sm disabled"
                        >
                          <i class="far fa-sync fa-spin"></i> Actualizando
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
                <div
                  class="tab-pane fade"
                  id="v-pills-cuenta"
                  role="tabpanel"
                  aria-labelledby="v-pills-cuenta-tab"
                >
                  <h4 class="card-title">Configuración de la cuenta</h4>
                  <h5 class="text-muted">Cambiar contraseña</h5>
                  <div class="row">
                    <div class="col-3">
                      <form
                        ngNativeValidate
                        [formGroup]="formPassword"
                        (ngSubmit)="actualizarPassword()"
                      >
                        <div class="row">
                          <div class="form-group col-12">
                            <label for="password">Contraseña nueva</label>

                            <div class="input-group">
                              <input
                                #password
                                formControlName="password"
                                name="password"
                                [attr.type]="verPassword"
                                class="form-control"
                                placeholder="Nueva contraseña..."
                                required
                              />
                              <div class="input-group-append">
                                <button
                                  *ngIf="verPassword === 'password'"
                                  (click)="verInputPassword()"
                                  class="btn btn-outline-secondary"
                                  type="button"
                                  id="button-addon1"
                                >
                                  <i class="fas fa-eye"></i>
                                </button>
                                <button
                                  *ngIf="verPassword === 'text'"
                                  (click)="verInputPassword()"
                                  class="btn btn-outline-secondary"
                                  type="button"
                                  id="button-addon1"
                                >
                                  <i class="fas fa-eye-slash"></i>
                                </button>
                              </div>
                            </div>
                            <div
                              *ngIf="fp.password.errors?.minlength"
                              class="invalid-feedback"
                              style="display: block;"
                            >
                              La contraseña debe tener al menos 8 caracteres
                            </div>
                          </div>
                          <div class="form-group col-12">
                            <label for="confirmaPassword"
                              >Confirmar contraseña</label
                            >
                            <input
                              formControlName="confirmaPassword"
                              name="confirmaPassword"
                              type="password"
                              class="form-control"
                              placeholder="Confirmar contraseña..."
                              required
                            />
                            <div
                              *ngIf="
                                fp.confirmaPassword.errors?.noSonIguales &&
                                !fp.confirmaPassword.pristine
                              "
                              class="invalid-feedback"
                              style="display: block;"
                            >
                              Las contraseñas deben coincidir
                            </div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-12 text-right">
                            <button
                              *ngIf="!cargando"
                              [disabled]="formPassword.invalid"
                              type="submit"
                              class="btn btn-success btn-sm"
                            >
                              <i class="far fa-sync"></i> Actualizar
                            </button>
                            <button
                              *ngIf="cargando"
                              type="submit"
                              class="btn btn-success btn-sm disabled"
                            >
                              <i class="far fa-sync fa-spin"></i> Actualizando
                            </button>
                          </div>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
                <div
                  class="tab-pane fade"
                  id="v-pills-UDS"
                  role="tabpanel"
                  aria-labelledby="v-pills-UDS-tab"
                >
                  <h4 class="card-title">Unidades de Servicio asignadas</h4>
                  <h6
                    *ngIf="udsAsignadas.length === 0"
                    class="card-subtitle mb-2 text-muted"
                  >
                    No tienes UDS asignadas.
                  </h6>
                  <table
                    *ngIf="udsAsignadas.length > 0"
                    class="table table-hover"
                  >
                    <thead>
                      <tr>
                        <th>Código</th>
                        <th>Nombre</th>
                        <th>Cupos</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let unidad of udsAsignadas">
                        <td>{{ unidad.codigo }}</td>
                        <td>{{ unidad.nombre }}</td>
                        <td>{{ unidad.cupos }}</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <!-- <div
                  class="tab-pane fade"
                  id="v-pills-settings"
                  role="tabpanel"
                  aria-labelledby="v-pills-settings-tab"
                >
                  <h4 class="card-title">Configuración</h4>
                </div> -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
