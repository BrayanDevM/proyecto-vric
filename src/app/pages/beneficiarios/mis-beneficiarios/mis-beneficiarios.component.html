<div class="page-wrapper">
  <div class="header row m-0 bg-white">
    <div class="page-title col-xl-6 p-0">
      <h2 class="title-bold m-0">Beneficiarios</h2>
      <div class="text-muted ml-1">
        <div>Lista de beneficiarios registrados</div>
      </div>
    </div>
    <div class="page-actions col-xl-6 p-0">
      <div class="mr-3">
        <mat-form-field appearance="outline" class="search-input">
          <!-- <mat-label></mat-label> -->
          <input
            matInput
            (keyup)="filtrarTabla($event)"
            placeholder="Buscar beneficiarios"
            autocomplete="off"
            #buscar
          />
          <mat-icon matPrefix>search</mat-icon>
          <!-- <mat-hint>Hint</mat-hint> -->
        </mat-form-field>
      </div>
      <!-- nothing -->
      <mat-form-field appearance="outlined" class="select">
        <!-- <mat-label>Filtrar por UDS</mat-label> -->
        <mat-select
          (selectionChange)="
            obtenerUds_beneficiarios_responsables($event.value)
          "
          placeholder="Seleccionar UDS"
        >
          <mat-option *ngFor="let unidad of udsAsignadas" [value]="unidad._id">
            {{ unidad.nombre }}
          </mat-option>
        </mat-select>
        <mat-icon matPrefix>home_work</mat-icon>
      </mat-form-field>
    </div>
  </div>
  <!-- PAGE CONTENT -->
  <div class="page-content p-0">
    <!--*/////////////////////////////// BENEFICIARIOS PENDIENTES *///////////////////////////////-->
    <!-- <div class="table-section">
      Pendientes
    </div> -->
    <div
      *ngIf="beneficiarios.length > 0; else noBeneficiarios"
      class="table-section-info border-bottom BDM_fadeInUp"
    >
      <!-- Pendiente vincular badge -->
      <div class="badge-status alert alert-primary mr-2">
        <div class="status-indicator bg-primary"></div>
        <span class="status-text"
          >Pendiente vincular ({{ pendientesVincular }})</span
        >
      </div>
      <!-- Pendiente desvincular badge -->
      <div class="badge-status alert alert-warning mr-2">
        <div class="status-indicator bg-warning"></div>
        <span class="status-text"
          >Pendiente desvincular ({{ pendientesDesvincular }})</span
        >
      </div>
      <!-- Dato sensible badge -->
      <div class="badge-status alert alert-info mr-2">
        <div class="status-indicator bg-info"></div>
        <span class="status-text">Dato sensible ({{ datosSensibles }})</span>
      </div>
      <!-- Concurrencia badge -->
      <div class="badge-status alert alert-danger mr-2">
        <div class="status-indicator bg-danger"></div>
        <span class="status-text">Concurrencia ({{ concurrencias }})</span>
      </div>
      <!-- Vinculado badge -->
      <div class="badge-status alert alert-success mr-2">
        <div class="status-indicator bg-success"></div>
        <span class="status-text">Vinculado ({{ vinculados }})</span>
      </div>
      <!-- Desvinculado badge -->
      <div class="badge-status alert alert-secondary mr-2">
        <div class="status-indicator bg-secondary"></div>
        <span class="status-text">Desvinculado ({{ desvinculados }})</span>
      </div>
    </div>
    <table
      mat-table
      *ngIf="beneficiarios.length > 0"
      [dataSource]="tablaData"
      class="mat-table contratos-lista mat-elevation-z8 BDM_fadeInUp"
    >
      <!-- Position Column -->
      <ng-container matColumnDef="tipoDoc">
        <th mat-header-cell *matHeaderCellDef>Doc.</th>
        <td mat-cell *matCellDef="let beneficiario">
          {{ beneficiario.tipoDoc }}
        </td>
      </ng-container>
      <!-- Position Column -->
      <ng-container matColumnDef="documento">
        <th mat-header-cell *matHeaderCellDef>NUIP</th>
        <td mat-cell *matCellDef="let beneficiario">
          {{ beneficiario.documento }}
        </td>
      </ng-container>
      <!-- Name Column -->
      <ng-container matColumnDef="nombre1">
        <th mat-header-cell *matHeaderCellDef>Primer nombre</th>
        <td mat-cell *matCellDef="let beneficiario">
          {{ beneficiario.nombre1 }}
        </td>
      </ng-container>
      <!-- Name Column -->
      <ng-container matColumnDef="nombre2">
        <th mat-header-cell *matHeaderCellDef>Segundo nombre</th>
        <td mat-cell *matCellDef="let beneficiario">
          {{ beneficiario.nombre2 }}
        </td>
      </ng-container>
      <!-- Name Column -->
      <ng-container matColumnDef="apellido1">
        <th mat-header-cell *matHeaderCellDef>Primer apellido</th>
        <td mat-cell *matCellDef="let beneficiario">
          {{ beneficiario.apellido1 }}
        </td>
      </ng-container>
      <!-- Name Column -->
      <ng-container matColumnDef="apellido2">
        <th mat-header-cell *matHeaderCellDef>Segundo apellido</th>
        <td mat-cell *matCellDef="let beneficiario">
          {{ beneficiario.apellido2 }}
        </td>
      </ng-container>
      <!-- Name Column -->
      <ng-container matColumnDef="nacimiento">
        <th mat-header-cell *matHeaderCellDef>F. Nacimiento</th>
        <td mat-cell *matCellDef="let beneficiario">
          {{ beneficiario.nacimiento }}
        </td>
      </ng-container>
      <ng-container matColumnDef="estado">
        <th mat-header-cell *matHeaderCellDef>Estado</th>
        <td mat-cell *matCellDef="let beneficiario">
          <div
            class="badge-status alert"
            [ngClass]="{
              'alert-primary': beneficiario.estado === 'Pendiente vincular',
              'alert-warning': beneficiario.estado === 'Pendiente desvincular',
              'alert-info': beneficiario.estado === 'Dato sensible',
              'alert-danger': beneficiario.estado === 'Concurrencia',
              'alert-success': beneficiario.estado === 'Vinculado',
              'alert-secondary': beneficiario.estado === 'Desvinculado'
            }"
          >
            <div
              class="status-indicator"
              [ngClass]="{
                'bg-primary': beneficiario.estado === 'Pendiente vincular',
                'bg-warning': beneficiario.estado === 'Pendiente desvincular',
                'bg-info': beneficiario.estado === 'Dato sensible',
                'bg-danger': beneficiario.estado === 'Concurrencia',
                'bg-success': beneficiario.estado === 'Vinculado',
                'bg-secondary': beneficiario.estado === 'Desvinculado'
              }"
            ></div>
            <span class="status-text">{{ beneficiario.estado }}</span>
          </div>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="tablaColumnas; sticky: true"></tr>
      <tr
        mat-row
        (click)="verBeneficiario(beneficiario._id)"
        *matRowDef="let row; let beneficiario; columns: tablaColumnas"
      ></tr>
      <!-- Row shown when there is no matching data. -->
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="8">
          No se encontraton beneficiarios de servicio con "{{ buscar.value }}"
        </td>
      </tr>
    </table>

    <ng-template #noBeneficiarios>
      <div class="no-data border-top BDM_fadeInUp">
        <img src="assets/img/svg/Business concep - VRIC.svg" />
        <span>No hay beneficiarios, ya intentaste seleccionar una UDS?</span>
      </div>
    </ng-template>
  </div>
</div>
